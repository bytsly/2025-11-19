# 投票抽奖系统 - 窗口模式快速指南

## 🎉 系统已升级为GUI窗口模式！

现在您可以通过友好的图形界面来管理投票抽奖系统，无需面对黑色的命令行窗口。

## 📖 快速开始

### 开发环境（适合开发者）

**方法1：双击运行**
```
📁 找到文件：启动GUI.bat
🖱️ 双击运行
⏳ 等待GUI窗口打开
```

**方法2：命令行运行**
```batch
# 1. 激活虚拟环境
venv\Scripts\activate

# 2. 启动GUI
python gui_app.py
```

### 生产环境（适合最终用户）

**步骤1：打包成EXE**
```
📁 找到文件：打包exe.bat
🖱️ 双击运行
⏳ 等待打包完成（约2-5分钟）
```

**步骤2：使用EXE程序**
```
📁 进入目录：dist\投票抽奖系统
🖱️ 双击文件：投票抽奖系统.exe
✨ GUI窗口自动打开
```

## 🎯 界面操作指南

### 界面布局
```
┌─────────────────────────────────────────┐
│          投票抽奖系统 v1.0              │
├─────────────────────────────────────────┤
│  【系统信息】                           │
│  • 系统名称: 投票抽奖系统               │
│  • 服务器地址: http://localhost:5000   │
│  • 运行状态: ● 运行中 / ● 已停止       │
├─────────────────────────────────────────┤
│  【控制面板】                           │
│  [▶ 启动服务] [■ 停止服务] [↻ 重启服务]│
│  [🏠 打开首页] [⚙ 管理后台]            │
│  [📊 投票页面] [🎰 抽奖页面]            │
├─────────────────────────────────────────┤
│  【运行日志】                           │
│  ┌───────────────────────────────────┐ │
│  │ [2024-01-01 10:00:00] 服务启动..│ │
│  │ [2024-01-01 10:00:01] 启动成功  │ │
│  │                                   │ │
│  └───────────────────────────────────┘ │
│  [清空日志] [导出日志]                 │
└─────────────────────────────────────────┘
```

### 按钮说明

#### 服务控制区
| 按钮 | 功能 | 说明 |
|------|------|------|
| ▶ 启动服务 | 启动Web服务器 | 首次使用必须点击此按钮 |
| ■ 停止服务 | 停止Web服务器 | 暂停服务但不关闭窗口 |
| ↻ 重启服务 | 重启Web服务器 | 修改配置后需要重启 |

#### 快速访问区
| 按钮 | 功能 | 说明 |
|------|------|------|
| 🏠 打开首页 | 浏览器打开系统首页 | 查看系统概览 |
| ⚙ 管理后台 | 浏览器打开管理界面 | 管理候选人、查看数据 |
| 📊 投票页面 | 浏览器打开投票页面 | 用户投票界面 |
| 🎰 抽奖页面 | 浏览器打开抽奖页面 | 进行抽奖活动 |

#### 日志管理区
| 按钮 | 功能 | 说明 |
|------|------|------|
| 清空日志 | 清除所有显示的日志 | 不影响系统运行 |
| 导出日志 | 保存日志到txt文件 | 用于问题排查 |

## 📋 使用流程

### 标准使用流程
```
1️⃣ 打开GUI窗口
   ↓
2️⃣ 点击"启动服务"
   ↓
3️⃣ 等待状态变为"● 运行中"
   ↓
4️⃣ 点击"管理后台"添加候选人
   ↓
5️⃣ 点击"投票页面"或"抽奖页面"使用功能
   ↓
6️⃣ 使用完毕后点击"停止服务"
   ↓
7️⃣ 关闭GUI窗口
```

### 首次使用配置
```
1️⃣ 启动GUI窗口
   ↓
2️⃣ 点击"启动服务"
   ↓
3️⃣ 点击"管理后台"
   ↓
4️⃣ 在管理后台：
   • 添加候选人信息
   • 上传候选人照片
   • 设置投票规则
   ↓
5️⃣ 点击"投票页面"测试投票
   ↓
6️⃣ 点击"抽奖页面"测试抽奖
```

## 🔧 配置修改

### 修改端口号
1. 找到 `.env` 文件（在程序根目录）
2. 用记事本打开
3. 修改 `PORT=5000` 为其他端口，如 `PORT=8080`
4. 保存文件
5. 在GUI窗口点击"重启服务"

### 允许局域网访问
1. 打开 `.env` 文件
2. 确认 `HOST=0.0.0.0`
3. 保存文件
4. 重启服务
5. 在其他设备浏览器输入：`http://您的电脑IP:5000`

## ⚠️ 注意事项

### ✅ 正确做法
- ✓ 先点击"启动服务"再访问页面
- ✓ 修改配置后记得重启服务
- ✓ 定期导出日志备份
- ✓ 数据库文件定期备份（database/voting.db）

### ❌ 常见错误
- ✗ 不启动服务就直接打开浏览器
- ✗ 关闭GUI窗口后还想访问页面
- ✗ 端口被占用时强行启动
- ✗ 不保存配置文件就重启

## 🐛 问题排查

### 问题1：GUI窗口打不开
**症状**：双击exe没反应

**解决方案**：
1. 检查是否被杀毒软件拦截
2. 查看任务管理器是否有进程在运行
3. 尝试以管理员身份运行

### 问题2：点击启动服务失败
**症状**：日志显示端口被占用

**解决方案**：
```batch
# 查看哪个程序占用了5000端口
netstat -ano | findstr :5000

# 结束占用端口的程序，或修改.env中的端口号
```

### 问题3：浏览器打不开页面
**症状**：点击按钮后浏览器显示无法访问

**解决方案**：
1. 确认服务状态是"● 运行中"
2. 检查日志区是否有错误信息
3. 手动在浏览器输入：http://localhost:5000
4. 检查防火墙设置

### 问题4：局域网其他设备无法访问
**症状**：本机能访问，其他设备不能

**解决方案**：
1. 确认 .env 中 HOST=0.0.0.0
2. 关闭Windows防火墙或添加入站规则
3. 使用电脑的实际IP地址（在GUI窗口可以看到）

### 问题5：程序运行卡顿
**症状**：界面操作缓慢

**解决方案**：
1. 清空日志（日志太多会影响性能）
2. 重启服务
3. 关闭不必要的浏览器标签页

## 📊 日志颜色含义

| 颜色 | 级别 | 说明 |
|------|------|------|
| 🟢 绿色 | SUCCESS | 操作成功，如"服务启动成功" |
| 🟠 橙色 | WARNING | 警告信息，如"正在停止服务" |
| 🔴 红色 | ERROR | 错误信息，需要处理 |
| ⚫ 黑色 | INFO | 普通信息，如日志记录 |

## 💾 数据和文件位置

### 重要文件
```
投票抽奖系统/
├── database/
│   └── voting.db          # 数据库（候选人、投票、抽奖记录）
├── uploads/
│   ├── photos/            # 候选人照片
│   └── files/             # 导入的Excel文件
├── .env                   # 配置文件
└── 投票抽奖系统.exe       # 主程序（打包后）
```

### 备份建议
定期备份以下文件：
- ✓ `database/voting.db` - 所有数据
- ✓ `uploads/photos/` - 候选人照片
- ✓ `.env` - 配置信息

## 🎓 进阶技巧

### 技巧1：快速重启
```
Ctrl + R (自定义快捷键)
或
点击 ↻ 重启服务按钮
```

### 技巧2：查看完整地址
启动服务后，在"系统信息"区域会显示：
- 本地访问地址：http://localhost:5000
- 局域网访问地址：http://192.168.x.x:5000

### 技巧3：日志搜索
在日志文本框中：
- Ctrl + F：查找特定内容
- Ctrl + A：全选日志
- Ctrl + C：复制日志

## 📞 获取帮助

### 文档资源
- `README.md` - 完整功能说明
- `GUI窗口模式说明.md` - 详细技术文档
- `启动说明.txt` - 简要使用说明

### 自助排查
1. 查看日志区的错误信息
2. 导出日志文件分析
3. 检查.env配置文件
4. 重启程序尝试

---

## 🎊 开始享受GUI窗口模式吧！

**提示**：如果您习惯命令行模式，依然可以使用 `python run.py` 启动终端版本。

**祝使用愉快！** ✨
